#!/usr/bin/env python3
"""
–¢–µ—Å—Ç —Ä–µ–∂–∏–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
"""
import os
import sys
from dotenv import load_dotenv

# –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤ PYTHONPATH
sys.path.insert(0, os.path.dirname(os.path.abspath(__file__)))

# –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
load_dotenv()

def test_deployment_check():
    """–¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–µ–∂–∏–º –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è"""
    print("=== üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –†–ï–ñ–ò–ú–ê –ü–†–û–í–ï–†–ö–ò –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–Ø ===")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    required_env_vars = ["TELFIN_HOSTNAME", "TELFIN_LOGIN", "TELFIN_PASSWORD", "YANDEX_API_KEY", "OPENAI_API_KEY"]
    missing_vars = [var for var in required_env_vars if not os.getenv(var)]
    
    if missing_vars:
        print(f"‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è: {', '.join(missing_vars)}")
        return False
    
    print("‚úÖ –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã")
    
    try:
        # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∏ –∑–∞–ø—É—Å–∫–∞–µ–º —Ä–µ–∂–∏–º –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
        from main import main_new
        
        print("\nüöÄ –ó–∞–ø—É—Å–∫–∞–µ–º —Ä–µ–∂–∏–º –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è...")
        print("üìû –ë—É–¥—É—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 –∑–≤–æ–Ω–∫–∞ (–∏–≥–Ω–æ—Ä–∏—Ä—É—è –∏—Å—Ç–æ—Ä–∏—é)")
        
        main_new(deployment_check=True)
        
        print("\n‚úÖ –¢–ï–°–¢ –†–ï–ñ–ò–ú–ê –ü–†–û–í–ï–†–ö–ò –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–Ø –ó–ê–í–ï–†–®–ï–ù")
        return True
        
    except Exception as e:
        print(f"\n‚ùå –û–®–ò–ë–ö–ê –í –¢–ï–°–¢–ï –ü–†–û–í–ï–†–ö–ò –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–Ø: {e}")
        import traceback
        traceback.print_exc()
        return False

if __name__ == "__main__":
    success = test_deployment_check()
    if success:
        print("\nüéâ –†–µ–∂–∏–º –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!")
        print("üöÄ –ì–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –Ω–∞ Heroku")
    else:
        print("\n‚ö†Ô∏è –ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å —Ä–µ–∂–∏–º–æ–º –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è")